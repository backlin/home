# Load CRAN packages
pkg <- c("devtools", "xtermStyle", "dataview",
         #"data.table",
         "magrittr", "tidyr", "dplyr")
pkg.installed <- sapply(pkg, require, quietly=TRUE, character.only = TRUE)
if(any(!pkg.installed)){
    cat("Could not load some of Christofer's start-up package(s),", 
        "type the following to install them and restart R:\n   install.packages(",
        paste('"', pkg[!pkg.installed], '"', sep="", collapse=", "),
        ")\n", sep="")
}
rm(pkg, pkg.installed)

# dataview
if("package:dataview" %in% search()){
    ev <- function(...) entry.view(...)
    hv <- heat.view
    if(!grepl("RStudio", session_info()$platform$ui)){
        print.factor <- heat.view
    }

    # Save this for the whos-masking below
    if(!exists("startup.objs"))
        startup.objs <- c(ls(all.names=TRUE), "startup.objs")
    # Keep in workspace to be saved and loaded together with in
    whos.exclude(startup.objs)

    if("package:data.table" %in% search()){
        opt <- default.options()
        opt$columns$Key <- NULL
        opt$columns$keyed <- haskey
        opt$print$comment <- function(x) ifelse(x, "+!", "")
        opt$print$keyed <- function(x) ifelse(x, "╥─o", "")
        options(dataview = opt)
    }
}

# Vim integration
if(!require("vimcom", quietly=TRUE)){
    cat("Vim integration not installed, see http://www.lepem.ufc.br/jaa/vimcom.html for instructions.\n")
} else {
    options(vimcom.verbose = 1)
}

# My miscellaneous functions
if(!require("Bmisc", quietly=TRUE)){
    cat("The `Bmisc` package is not installed.\n")
}

